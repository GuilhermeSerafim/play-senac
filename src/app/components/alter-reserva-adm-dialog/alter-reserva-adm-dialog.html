<form
  class="form-container"
  #facaSuaReservaFormControl="ngForm"
  (ngSubmit)="onSubmit()"
>
  <h1 mat-dialog-title>Alterar reserva</h1>
  
  <mat-dialog-content class="mat-typography">
    
    <!-- QUADRA -->
    <mat-form-field [style.marginTop.px]="30" appearance="outline" class="full-width form-container__item">
      <mat-label>Selecione a quadra</mat-label>
      <mat-select
        name="quadraSelecionada"
        [(ngModel)]="quadraSelecionada"
        #quadraSelecionadaControl="ngModel"
        required
      >
        @for (quadra of quadras; track quadra.id) {
          <mat-option [value]="quadra">{{ quadra.title }}</mat-option>
        }
      </mat-select>
      @if (quadraSelecionadaControl.hasError('required')) {
        <mat-error> O campo quadra é obrigatório. </mat-error>
      }
    </mat-form-field>

    <!-- DATA -->
    <mat-form-field appearance="outline" class="full-width form-container__item">
      <mat-label>Selecione a data</mat-label>
      <input
        required
        name="dataSelecionada"
        [(ngModel)]="dataSelecionada"
        #dataSelecionadaControl="ngModel"
        matInput
        [matDatepicker]="picker"
        readonly
      />
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
      @if (dataSelecionadaControl.hasError('required')) {
        <mat-error> A data é obrigatória. </mat-error>
      }
    </mat-form-field>

    <!-- ÁREA DE HORÁRIOS (Lado a Lado) -->
    <div style="display: flex; gap: 16px;">
      
      <!-- Horário Início -->
      <mat-form-field appearance="outline" style="flex: 1;">
        <mat-label>Início</mat-label>
        <input
          required
          matInput
          [matTimepicker]="pickerInicio"
          [(ngModel)]="horarioInicioSelecionado"
          name="horarioInicioSelecionado"
          #inicioControl="ngModel"
          matTimepickerMin="06:00"
          matTimepickerMax="23:00"
        />
        <mat-timepicker #pickerInicio />
        <mat-timepicker-toggle [for]="pickerInicio" matSuffix />
        @if (inicioControl.hasError('required')) {
          <mat-error>Obrigatório</mat-error>
        }
      </mat-form-field>

      <!-- Horário Fim -->
      <mat-form-field appearance="outline" style="flex: 1;">
        <mat-label>Fim</mat-label>
        <input
          required
          matInput
          [matTimepicker]="pickerFim"
          [(ngModel)]="horarioFimSelecionado"
          name="horarioFimSelecionado"
          #fimControl="ngModel"
          matTimepickerMin="06:00"
          matTimepickerMax="23:00"
        />
        <mat-timepicker #pickerFim />
        <mat-timepicker-toggle [for]="pickerFim" matSuffix />
        @if (fimControl.hasError('required')) {
          <mat-error>Obrigatório</mat-error>
        }
      </mat-form-field>
    </div>

    <!-- MENSAGEM DE ERRO DE INTERVALO (Customizada) -->
    <!-- Só aparece se os campos estiverem preenchidos mas a lógica estiver errada -->
    @if (erroDeHorario && horarioInicioSelecionado && horarioFimSelecionado) {
      <div style="color: #f44336; font-size: 12px; margin-top: -10px; margin-bottom: 10px; display: flex; align-items: center; gap: 5px;">
        <mat-icon style="font-size: 16px; height: 16px; width: 16px;">error</mat-icon>
        <span>{{ erroDeHorario }}</span>
      </div>
    }


  </mat-dialog-content>

  <!-- AÇÕES -->
  <mat-dialog-actions align="end">
    <button mat-raised-button class="btn-cancelar" mat-dialog-close type="button" color="warn">Cancelar</button>

    <button
      mat-raised-button
      class="btn-confirmar"
      color="primary"
      type="submit"
      [disabled]="facaSuaReservaFormControl.invalid || erroDeHorario"
      [ngStyle]="(facaSuaReservaFormControl.invalid || erroDeHorario) ? { backgroundColor: '#9e9e9e', cursor: 'not-allowed', color: '#ffffff' } : {}"
    >
      Confirmar
    </button>
  </mat-dialog-actions>
</form>